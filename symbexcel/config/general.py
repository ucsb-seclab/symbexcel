import z3

# import string

XL4_FORMULAS = ["A1.R1C1", "ABS", "ABSREF", "ACCRINT", "ACCRINTM", "ACOS", "ACOSH", "ACOT", "ACOTH", "ACTIVATE",
                "ACTIVATE.NEXT", "ACTIVATE.PREV", "ACTIVE.CELL", "ACTIVE.CELL.FONT", "ADD.ARROW", "ADD.BAR",
                "ADD.CHART.AUTOFORMAT", "ADD.COMMAND", "ADD.LIST.ITEM", "ADD.MENU", "ADD.OVERLAY", "ADD.TOOL",
                "ADD.TOOLBAR", "ADDIN.MANAGER", "ADDRESS", "AGGREGATE", "ALERT", "ALIGNMENT", "AMORDEGRC", "AMORLINC",
                "AND", "ANOVA1", "ANOVA2", "ANOVA3", "APP.ACTIVATE", "APP.ACTIVATE.MICROSOFT", "APP.MAXIMIZE",
                "APP.MINIMIZE", "APP.MOVE", "APP.RESTORE", "APP.SIZE", "APP.TITLE", "APPLY.NAMES", "APPLY.STYLE",
                "ARABIC", "AREAS", "ARGUMENT", "ARRANGE.ALL", "ARRAYTOTEXT", "ASC", "ASIN", "ASINH", "ASSIGN.TO.OBJECT",
                "ASSIGN.TO.TOOL", "ATAN", "ATAN2", "ATANH", "ATTACH.TEXT", "ATTACH.TOOLBARS", "AUTO.OUTLINE", "AVEDEV",
                "AVERAGE", "AVERAGEA", "AVERAGEIF", "AVERAGEIFS", "AXES", "BAHTTEXT", "BASE", "BEEP", "BESSELI",
                "BESSELJ", "BESSELK", "BESSELY", "BETA.DIST", "BETA.INV", "BETADIST", "BETAINV", "BIN2DEC", "BIN2HEX",
                "BIN2OCT", "BINOM.DIST", "BINOM.DIST.RANGE", "BINOM.INV", "BINOMDIST", "BITAND", "BITLSHIFT", "BITOR",
                "BITRSHIFT", "BITXOR", "BORDER", "BREAK", "BRING.TO.FRONT", "CALCULATE.DOCUMENT", "CALCULATE.NOW",
                "CALCULATION", "CALL", "CALLER", "CANCEL.COPY", "CANCEL.KEY", "CEILING", "CEILING.MATH",
                "CEILING.PRECISE", "CELL", "CELL.PROTECTION", "CHANGE.LINK", "CHAR", "CHART.ADD.DATA", "CHART.TREND",
                "CHART.WIZARD", "CHECK.COMMAND", "CHECKBOX.PROPERTIES", "CHIDIST", "CHIINV", "CHISQ.DIST",
                "CHISQ.DIST.RT", "CHISQ.INV", "CHISQ.INV.RT", "CHISQ.TEST", "CHITEST", "CHOOSE", "CLEAN", "CLEAR",
                "CLEAR.OUTLINE", "CLEAR.ROUTING.SLIP", "CLOSE", "CLOSE.ALL", "CODE", "COLOR.PALETTE", "COLUMN",
                "COLUMN.WIDTH", "COLUMNS", "COMBIN", "COMBINA", "COMBINATION", "COMPLEX", "CONCAT", "CONCATENATE",
                "CONFIDENCE", "CONFIDENCE.NORM", "CONFIDENCE.T", "CONSOLIDATE", "CONSTRAIN.NUMERIC", "CONVERT", "COPY",
                "COPY.CHART", "COPY.PICTURE", "COPY.TOOL", "CORREL", "COS", "COSH", "COT", "COTH", "COUNT", "COUNTA",
                "COUNTBLANK", "COUNTIF", "COUNTIFS", "COUPDAYBS", "COUPDAYS", "COUPDAYSNC", "COUPNCD", "COUPNUM",
                "COUPPCD", "COVAR", "COVARIANCE.P", "COVARIANCE.S", "CREATE.NAMES", "CREATE.OBJECT", "CREATE.PUBLISHER",
                "CRITBINOM", "CSC", "CSCH", "CUBEKPIMEMBER", "CUBEMEMBER", "CUBEMEMBERPROPERTY", "CUBERANKEDMEMBER",
                "CUBESET", "CUBESETCOUNT", "CUBEVALUE", "CUMIPMT", "CUMPRINC", "CUSTOM.REPEAT", "CUSTOM.UNDO",
                "CUSTOMIZE.TOOLBAR", "CUT", "DATA.DELETE", "DATA.FIND", "DATA.FIND.NEXT", "DATA.FIND.PREV", "DATA.FORM",
                "DATA.LABEL", "DATA.SERIES", "DATE", "DATEDIF", "DATEVALUE", "DAVERAGE", "DAY", "DAYS", "DAYS360", "DB",
                "DBCS", "DCOUNT", "DCOUNTA", "DDB", "DEC2BIN", "DEC2HEX", "DEC2OCT", "DECIMAL", "DEFINE.NAME",
                "DEFINE.STYLE", "DEGREES", "DELETE.ARROW", "DELETE.BAR", "DELETE.CHART.AUTOFORMAT", "DELETE.COMMAND",
                "DELETE.FORMAT", "DELETE.MENU", "DELETE.NAME", "DELETE.OVERLAY", "DELETE.STYLE", "DELETE.TOOL",
                "DELETE.TOOLBAR", "DELTA", "DEMOTE", "DEREF", "DESCR", "DEVSQ", "DGET", "DIALOG.BOX", "DIRECTORY",
                "DISABLE.INPUT", "DISC", "DISPLAY", "DMAX", "DMIN", "DOCUMENTS", "DOLLAR", "DOLLARDE", "DOLLARFR",
                "DPRODUCT", "DSTDEV", "DSTDEVP", "DSUM", "DUPLICATE", "DURATION", "DVAR", "DVARP", "ECHO", "EDATE",
                "EDIT.COLOR", "EDIT.DELETE", "EDIT.OBJECT", "EDIT.REPEAT", "EDIT.SERIES", "EDIT.TOOL",
                "EDITBOX.PROPERTIES", "EDITION.OPTIONS", "EFFECT", "ELSE", "ELSE.IF", "EMBED", "ENABLE.COMMAND",
                "ENABLE.OBJECT", "ENABLE.TIPWIZARD", "ENABLE.TOOL", "ENCODEURL", "END.IF", "ENTER.DATA", "EOMONTH",
                "ERF", "ERF.PRECISE", "ERFC", "ERFC.PRECISE", "ERROR", "ERROR.TYPE", "ERRORBAR.X", "ERRORBAR.Y",
                "EUROCONVERT", "EVALUATE", "EVEN", "EXACT", "EXEC", "EXECUTE", "EXP", "EXPON", "EXPON.DIST",
                "EXPONDIST", "EXTEND.POLYGON", "EXTRACT", "F.DIST", "F.DIST.RT", "F.INV", "F.INV.RT", "F.TEST", "FACT",
                "FACTDOUBLE", "FALSE", "FCLOSE", "FDIST", "FILE.CLOSE", "FILE.DELETE", "FILES", "FILL.AUTO",
                "FILL.DOWN", "FILL.GROUP", "FILL.LEFT", "FILL.RIGHT", "FILL.UP", "FILTER", "FILTER.ADVANCED",
                "FILTER.SHOW.ALL", "FILTERXML", "FIND", "FIND.FILE", "FINDB", "FINV", "FISHER", "FISHERINV", "FIXED",
                "FLOOR", "FLOOR.MATH", "FLOOR.PRECISE", "FONT", "FONT.PROPERTIES", "FOPEN", "FOR", "FOR.CELL",
                "FORECAST", "FORECAST.ETS", "FORECAST.ETS.CONFINT", "FORECAST.ETS.SEASONALITY", "FORECAST.ETS.STAT",
                "FORECAST.LINEAR", "FORMAT.AUTO", "FORMAT.CHART", "FORMAT.CHARTTYPE", "FORMAT.FONT", "FORMAT.LEGEND",
                "FORMAT.MAIN", "FORMAT.MOVE", "FORMAT.NUMBER", "FORMAT.OVERLAY", "FORMAT.SHAPE", "FORMAT.SIZE",
                "FORMAT.TEXT", "FORMULA", "FORMULA.ARRAY", "FORMULA.CONVERT", "FORMULA.FILL", "FORMULA.FIND",
                "FORMULA.FIND.NEXT", "FORMULA.FIND.PREV", "FORMULA.GOTO", "FORMULA.REPLACE", "FORMULATEXT", "FOURIER",
                "FPOS", "FREAD", "FREADLN", "FREEZE.PANES", "FREQUENCY", "FSIZE", "FTEST", "FTESTV", "FULL",
                "FULL.SCREEN", "FUNCTION.WIZARD", "FV", "FVSCHEDULE", "FWRITE", "FWRITELN", "GALLERY",
                "GALLERY.3D.AREA", "GALLERY.3D.BAR", "GALLERY.3D.COLUMN", "GALLERY.3D.LINE", "GALLERY.3D.PIE",
                "GALLERY.3D.SURFACE", "GALLERY.AREA", "GALLERY.BAR", "GALLERY.CUSTOM", "GALLERY.DOUGHNUT",
                "GALLERY.PIE", "GALLERY.RADAR", "GALLERY.SCATTER", "GAMMA", "GAMMA.DIST", "GAMMA.INV", "GAMMADIST",
                "GAMMAINV", "GAMMALN", "GAMMALN.PRECISE", "GAUSS", "GCD", "GEOMEAN", "GESTEP", "GET.BAR", "GET.CELL",
                "GET.CHART.ITEM", "GET.DEF", "GET.DOCUMENT", "GET.FORMULA", "GET.LINK.INFO", "GET.NAME", "GET.NOTE",
                "GET.OBJECT", "GET.PIVOT.FIELD", "GET.PIVOT.ITEM", "GET.PIVOT.TABLE", "GET.TOOL", "GET.TOOLBAR",
                "GET.WINDOW", "GET.WORKBOOK", "GET.WORKSPACE", "GETPIVOTDATA", "GOAL.SEEK", "GOTO", "GRIDLINES",
                "GROUP", "GROWTH", "HALT", "HARMEAN", "HELP", "HEX2BIN", "HEX2DEC", "HEX2OCT", "HIDE", "HIDE.DIALOG",
                "HIDE.OBJECT", "HISTOGRAM", "HLINE", "HLOOKUP", "HOUR", "HPAGE", "HSCROLL", "HYPERLINK", "HYPGEOM.DIST",
                "HYPGEOMDIST", "IF", "IFERROR", "IFNA", "IFS", "IMABS", "IMAGINARY", "IMARGUMENT", "IMCONJUGATE",
                "IMCOS", "IMCOSH", "IMCOT", "IMCSC", "IMCSCH", "IMDIV", "IMEXP", "IMLN", "IMLOG10", "IMLOG2", "IMPOWER",
                "IMPRODUCT", "IMREAL", "IMSEC", "IMSECH", "IMSIN", "IMSINH", "IMSQRT", "IMSUB", "IMSUM", "IMTAN",
                "INDEX", "INDIRECT", "INFO", "INITIATE", "INPUT", "INSERT", "INSERT.OBJECT", "INSERT.PICTURE",
                "INSERT.TITLE", "INT", "INTERCEPT", "INTRATE", "IPMT", "IRR", "ISBLANK", "ISERR", "ISERROR", "ISEVEN",
                "ISFORMULA", "ISLOGICAL", "ISNA", "ISNONTEXT", "ISNUMBER", "ISO.CEILING", "ISODD", "ISOWEEKNUM",
                "ISPMT", "ISREF", "ISTEXT", "JIS", "JUSTIFY", "KURT", "LABEL.PROPERTIES", "LARGE", "LAST.ERROR", "LCM",
                "LEFT", "LEFTB", "LEGEND", "LEN", "LENB", "LET", "LINE.PRINT", "LINEST", "LINK.COMBO", "LINK.FORMAT",
                "LINKS", "LIST.NAMES", "LISTBOX.PROPERTIES", "LN", "LOG", "LOG10", "LOGEST", "LOGINV", "LOGNORM.DIST",
                "LOGNORM.INV", "LOGNORMDIST", "LOOKUP", "LOWER", "MACRO.OPTIONS", "MAIL.ADD.MAILER",
                "MAIL.DELETE.MAILER", "MAIL.EDIT.MAILER", "MAIL.FORWARD", "MAIL.LOGOFF", "MAIL.LOGON",
                "MAIL.NEXT.LETTER", "MAIL.REPLY", "MAIL.REPLY.ALL", "MAIL.SEND.MAILER", "MAIN.CHART", "MAIN.CHART.TYPE",
                "MATCH", "MAX", "MAXA", "MAXIFS", "MCORREL", "MCOVAR", "MDETERM", "MDURATION", "MEDIAN", "MENU.EDITOR",
                "MERGE.STYLES", "MESSAGE", "MID", "MIDB", "MIN", "MINA", "MINIFS", "MINUTE", "MINVERSE", "MIRR", "MMULT",
                "MOD", "MODE", "MODE.MULT", "MODE.SNGL", "MONTH", "MOVE", "MOVE.TOOL", "MOVEAVG", "MROUND",
                "MULTINOMIAL", "MUNIT", "N", "NA", "NAMES", "NEGBINOM.DIST", "NEGBINOMDIST", "NETWORKDAYS",
                "NETWORKDAYS.INTL", "NEW", "NEW.WINDOW", "NEXT", "NOMINAL", "NORM.DIST", "NORM.INV", "NORM.S.DIST",
                "NORM.S.INV", "NORMDIST", "NORMINV", "NORMSDIST", "NORMSINV", "NOT", "NOTE", "NOW", "NPER", "NPV",
                "NUMBERVALUE", "OBJECT.PROPERTIES", "OBJECT.PROTECTION", "OCT2BIN", "OCT2DEC", "OCT2HEX", "ODD",
                "ODDFPRICE", "ODDFYIELD", "ODDLPRICE", "ODDLYIELD", "OFFSET", "ON.DATA", "ON.DOUBLECLICK", "ON.ENTRY",
                "ON.KEY", "ON.RECALC", "ON.SHEET", "ON.TIME", "ON.WINDOW", "OPEN", "OPEN.DIALOG", "OPEN.LINKS",
                "OPEN.MAIL", "OPEN.TEXT", "OPTIONS.CALCULATION", "OPTIONS.CHART", "OPTIONS.EDIT", "OPTIONS.GENERAL",
                "OPTIONS.LISTS.ADD", "OPTIONS.LISTS.DELETE", "OPTIONS.LISTS.GET", "OPTIONS.TRANSITION", "OPTIONS.VIEW",
                "OR", "OUTLINE", "OVERLAY", "PAGE.SETUP", "PARSE", "PASTE", "PASTE.LINK", "PASTE.PICTURE",
                "PASTE.PICTURE.LINK", "PASTE.SPECIAL", "PASTE.TOOL", "PATTERNS", "PAUSE", "PDURATION", "PEARSON",
                "PERCENTILE", "PERCENTILE.EXC", "PERCENTILE.INC", "PERCENTRANK", "PERCENTRANK.EXC", "PERCENTRANK.INC",
                "PERMUT", "PERMUTATIONA", "PHI", "PHONETIC", "PI", "PIVOT.ADD.DATA", "PIVOT.ADD.FIELDS", "PIVOT.FIELD",
                "PIVOT.FIELD.GROUP", "PIVOT.FIELD.PROPERTIES", "PIVOT.FIELD.UNGROUP", "PIVOT.ITEM",
                "PIVOT.ITEM.PROPERTIES", "PIVOT.REFRESH", "PIVOT.SHOW.PAGES", "PIVOT.TABLE.WIZARD", "PLACEMENT", "PMT",
                "POISSON", "POISSON.DIST", "POKE", "POWER", "PPMT", "PRECISION", "PREFERRED", "PRESS.TOOL", "PRICE",
                "PRICEDISC", "PRICEMAT", "PRINT", "PRINT.PREVIEW", "PRINTER.SETUP", "PROB", "PRODUCT", "PROMOTE",
                "PROPER", "PROTECT.DOCUMENT", "PTTESTM", "PTTESTV", "PUSHBUTTON.PROPERTIES", "PV", "QUARTILE",
                "QUARTILE.EXC", "QUARTILE.INC", "QUERY.GET.DATA", "QUERY.REFRESH", "QUIT", "QUOTIENT", "RADIANS", "RAND",
                "RANDARRAY", "RANDBETWEEN", "RANDOM", "RANK", "RANK.AVG", "RANK.EQ", "RANKPERC", "RATE", "RECEIVED",
                "REFTEXT", "REGISTER", "REGISTER.ID", "REGRESS", "RELREF", "REMOVE.LIST.ITEM", "REMOVE.PAGE.BREAK",
                "RENAME.COMMAND", "RENAME.OBJECT", "REPLACE", "REPLACE.FONT", "REPLACEB", "REPORT.DEFINE",
                "REPORT.DELETE", "REPORT.GET", "REPORT.PRINT", "REPT", "REQUEST", "RESET.TOOL", "RESET.TOOLBAR",
                "RESTART", "RESULT", "RESUME", "RETURN", "RIGHT", "RIGHTB", "ROMAN", "ROUND", "ROUNDDOWN", "ROUNDUP",
                "ROUTE.DOCUMENT", "ROUTING.SLIP", "ROW", "ROW.HEIGHT", "ROWS", "RRI", "RSQ", "RTD", "RUN", "SAMPLE",
                "SAVE", "SAVE.AS", "SAVE.COPY.AS", "SAVE.DIALOG", "SAVE.TOOLBAR", "SAVE.WORKBOOK", "SAVE.WORKSPACE",
                "SCALE", "SCENARIO.ADD", "SCENARIO.CELLS", "SCENARIO.DELETE", "SCENARIO.EDIT", "SCENARIO.GET",
                "SCENARIO.MERGE", "SCENARIO.SHOW", "SCENARIO.SHOW.NEXT", "SCENARIO.SUMMARY", "SCROLLBAR.PROPERTIES",
                "SEARCH", "SEARCHB", "SEC", "SECH", "SECOND", "SELECT", "SELECT.CHART", "SELECT.END", "SELECT.LAST.CELL",
                "SELECT.LIST.ITEM", "SELECT.PLOT.AREA", "SELECT.SPECIAL", "SELECTION", "SEND.KEYS", "SEND.MAIL",
                "SEND.TO.BACK", "SEQUENCE", "SERIES", "SERIES.AXES", "SERIES.ORDER", "SERIES.X", "SERIES.Y",
                "SERIESSUM", "SET.CONTROL.VALUE", "SET.CRITERIA", "SET.DATABASE", "SET.DIALOG.DEFAULT",
                "SET.DIALOG.FOCUS", "SET.EXTRACT", "SET.LIST.ITEM", "SET.NAME", "SET.PAGE.BREAK", "SET.PREFERRED",
                "SET.PRINT.AREA", "SET.PRINT.TITLES", "SET.UPDATE.STATUS", "SET.VALUE", "SHEET", "SHEETS",
                "SHORT.MENUS", "SHOW.ACTIVE.CELL", "SHOW.BAR", "SHOW.CLIPBOARD", "SHOW.DETAIL", "SHOW.DIALOG",
                "SHOW.INFO", "SHOW.LEVELS", "SHOW.TOOLBAR", "SIGN", "SIN", "SINH", "SIZE", "SKEW", "SKEW.P",
                "SLIDE.COPY.ROW", "SLIDE.CUT", "SLIDE.DEFAULTS", "SLIDE.DELETE.ROW", "SLIDE.EDIT", "SLIDE.GET",
                "SLIDE.PASTE", "SLIDE.PASTE.ROW", "SLIDE.SHOW", "SLN", "SLOPE", "SMALL", "SOLVER.ADD", "SOLVER.CHANGE",
                "SOLVER.DELETE", "SOLVER.FINISH", "SOLVER.GET", "SOLVER.LOAD", "SOLVER.OK", "SOLVER.OPTIONS",
                "SOLVER.RESET", "SOLVER.SAVE", "SOLVER.SOLVE", "SORT", "SORTBY", "SOUND.NOTE", "SOUND.PLAY", "SPELLING",
                "SPELLING.CHECK", "SPLIT", "SQL.BIND", "SQL.CLOSE", "SQL.ERROR", "SQL.EXEC.QUERY", "SQL.GET.SCHEMA",
                "SQL.OPEN", "SQL.RETRIEVE", "SQL.RETRIEVE.TO.FILE", "SQRT", "SQRTPI", "STANDARD.FONT", "STANDARD.WIDTH",
                "STANDARDIZE", "STDEV", "STDEV.P", "STDEV.S", "STDEVA", "STDEVP", "STDEVPA", "STEP", "STEYX", "STYLE",
                "SUBSCRIBE.TO", "SUBSTITUTE", "SUBTOTAL", "SUBTOTAL.CREATE", "SUBTOTAL.REMOVE", "SUM", "SUMIF", "SUMIFS",
                "SUMMARY.INFO", "SUMPRODUCT", "SUMSQ", "SUMX2MY2", "SUMX2PY2", "SUMXMY2", "SWITCH", "SYD", "Syntaxes",
                "T", "T.DIST", "T.DIST.2T", "T.DIST.RT", "T.INV", "T.INV.2T", "T.TEST", "TAB.ORDER", "TABLE", "TAN",
                "TANH", "TBILLEQ", "TBILLPRICE", "TBILLYIELD", "TDIST", "TERMINATE", "TEXT", "TEXT.BOX",
                "TEXT.TO.COLUMNS", "TEXTJOIN", "TEXTREF", "TIME", "TIMEVALUE", "TINV", "Tips", "TODAY", "TRACER.CLEAR",
                "TRACER.DISPLAY", "TRACER.ERROR", "TRACER.NAVIGATE", "TRANSPOSE", "TREND", "TRIM", "TRIMMEAN", "TRUE",
                "TRUNC", "TTEST", "TTESTM", "TYPE", "UNDO", "UNGROUP", "UNHIDE", "UNICHAR", "UNICODE", "UNIQUE",
                "UNLOCKED.NEXT", "UNLOCKED.PREV", "UNREGISTER", "UPDATE.LINK", "UPPER", "VALUE", "VALUETOTEXT", "VAR",
                "VAR.P", "VAR.S", "VARA", "VARP", "VARPA", "VBA.INSERT.FILE", "VBA.MAKE.ADDIN", "VDB", "VIEW.3D",
                "VIEW.DEFINE", "VIEW.DELETE", "VIEW.GET", "VIEW.SHOW", "VLINE", "VLOOKUP", "VOLATILE", "VPAGE",
                "VSCROLL", "WAIT", "WEBSERVICE", "WEEKDAY", "WEEKNUM", "WEIBULL", "WEIBULL.DIST", "WHILE",
                "WINDOW.MAXIMIZE", "WINDOW.MINIMIZE", "WINDOW.MOVE", "WINDOW.RESTORE", "WINDOW.SIZE", "WINDOW.TITLE",
                "WINDOWS", "WORKBOOK.ACTIVATE", "WORKBOOK.ADD", "WORKBOOK.COPY", "WORKBOOK.DELETE", "WORKBOOK.HIDE",
                "WORKBOOK.INSERT", "WORKBOOK.MOVE", "WORKBOOK.NAME", "WORKBOOK.NEW", "WORKBOOK.NEXT", "WORKBOOK.OPTIONS",
                "WORKBOOK.PREV", "WORKBOOK.PROTECT", "WORKBOOK.SCROLL", "WORKBOOK.SELECT", "WORKBOOK.TAB.SPLIT",
                "WORKBOOK.UNHIDE", "WORKDAY", "WORKDAY.INTL", "WORKGROUP", "WORKSPACE", "XIRR", "XLOOKUP", "XMATCH",
                "XNPV", "XOR", "YEAR", "YEARFRAC", "YIELD", "YIELDDISC", "YIELDMAT", "Z.TEST", "ZOOM", "ZTEST", "ZTESTM"]

Z3_LOWERCASE_REGEX = z3.Range('a', 'z')  # z3.Union([z3.Re(z3.StringVal(c)) for c in string.ascii_lowercase])
Z3_UPPERCASE_REGEX = z3.Range('A', 'Z')  # z3.Union([z3.Re(z3.StringVal(c)) for c in string.ascii_uppercase])
Z3_LETTERS_REGEX = z3.Union(Z3_LOWERCASE_REGEX,
                            Z3_UPPERCASE_REGEX)  # z3.Union([z3.Re(z3.StringVal(c)) for c in string.ascii_letters])
Z3_DIGITS_REGEX = z3.Range('0', '9')  # z3.Union([z3.Re(z3.StringVal(c)) for c in string.digits])
Z3_ALPHANUM_REGEX = z3.Union(Z3_LETTERS_REGEX,
                             Z3_DIGITS_REGEX)  # z3.Union([z3.Re(z3.StringVal(c)) for c in string.ascii_letters+string.digits])
Z3_PRINTABLE_REGEX = z3.Range(chr(0x20), chr(0x7e))  # z3.Union([z3.Re(z3.StringVal(c)) for c in string.printable])
Z3_FORMULA_REGEX = z3.Concat(z3.Re("="), z3.Union([z3.Re(f) for f in XL4_FORMULAS]), z3.Re("("),
                             z3.Star(Z3_PRINTABLE_REGEX), z3.Re(")"))
